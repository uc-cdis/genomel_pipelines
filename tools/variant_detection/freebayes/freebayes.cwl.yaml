#!/usr/bin/env cwl-runner

cwlVersion: "cwl:draft-3"

class: CommandLineTool

requirements:
  - $import: ../../envvar-global.cwl
  - class: InlineJavascriptRequirement
  - class: DockerRequirement
    dockerPull: registry.gitlab.com/uc-cdis/genomel-exome-variant-detection:0.1b

inputs:
  - id: reference_fasta_path
    type: File
    inputBinding:
      position: 1
      prefix: "-f"
    secondaryFiles:
      - "^.dict"
      - ".fai"
  - id: input_bam_path
    type:
      type: array
      items: File
      inputBinding:
        prefix: "-I"
      secondaryFiles:
        - "^.bai"
    inputBinding:
      position: 4
  - id: interval_file_path
    type: ["null", File]
    inputBinding:
      position: 3
      prefix: "--targets"
  - id: output_vcf_name
    type: string
    inputBinding:
      position: 5
      prefix: "--vcf"

outputs:
- id: output_vcf
  type: File
  outputBinding:
    glob: $(inputs.output_vcf_name)

baseCommand: /home/ubuntu/tools/freebayes/bin/freebayes
arguments:
  - valueFrom: "6"
    position: 4
    prefix: "--use-best-n-alleles"

description: |
  FreeBayes is a Bayesian genetic variant detector designed to find small polymorphisms, specifically SNPs (single-nucleotide polymorphisms), indels (insertions and deletions), MNPs (multi-nucleotide polymorphisms), and complex events (composite insertion and substitution events) smaller than the length of a short-read sequencing alignment.
